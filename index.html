<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <title>Partido de Fútbol Sala</title>
</head>
<body>

  <h1 style="text-align: center;">Partido de Fútbol Sala</h1>

  <!-- Temporizador -->
  <div id="timer">Tiempo: 00:00</div>

  <!-- Campo de fútbol sala -->
  <div id="campo">
    <div class="jugador" id="jugador1"></div>
    <div class="jugador" id="jugador2"></div>
    <div class="jugador" id="jugador3"></div>
    <div class="jugador" id="jugador4"></div>
    <div class="jugador" id="jugador5"></div>
  </div>

  <!-- Botones para iniciar y pausar el partido -->
  <div style="text-align: center; margin-top: 20px;">
    <button id="iniciarPartido">Iniciar Partido</button>
    <button id="pausarPartido">Pausar Partido</button>
  </div>

  <!-- Sección para realizar acciones sobre un jugador -->
  <div id="accionesJugador">
    <label for="selectAccion">Seleccionar acción para el jugador: </label>
    <select id="selectAccion">
      <option value="gol">Gol</option>
      <option value="asistencia">Asistencia</option>
      <option value="tarjeta">Tarjeta</option>
      <option value="cambio">Cambiar jugador</option>
    </select>
    <button id="confirmarAccion">Confirmar Acción</button>
  </div>

  <!-- Sección para realizar cambios de jugadores -->
  <div id="cambioJugador">
    <label for="selectBanquillo">Seleccionar jugador del banquillo: </label>
    <select id="selectBanquillo"></select>
    <button id="confirmarCambio">Confirmar Cambio</button>
  </div>

  <script>
    // Mock de jugadores con números
    const jugadoresConvocados = [
      { nombre: 'Aitor', numero: 1 },
      { nombre: 'Peru', numero: 21 },
      { nombre: 'Javi O.', numero: 7 },
      { nombre: 'Christian', numero: 11 },
      { nombre: 'Mini', numero: 3 },
      { nombre: 'Adrián', numero: 77 },
      { nombre: 'Mario', numero: 4 },
      { nombre: 'Javi R.', numero: 5 },
      { nombre: 'Raúl', numero: 12 },
      { nombre: 'Rubi', numero: 10 }
    ];

    let jugadoresEnCancha = jugadoresConvocados.slice(0, 5);  // Los primeros 5 en cancha
    let jugadoresEnBanquillo = jugadoresConvocados.slice(5); // El resto en el banquillo

    const jugadoresElements = document.querySelectorAll('.jugador');
    const accionesJugadorDiv = document.getElementById('accionesJugador');
    const cambioJugadorDiv = document.getElementById('cambioJugador');
    const selectAccion = document.getElementById('selectAccion');
    const selectBanquillo = document.getElementById('selectBanquillo');
    const portero = document.getElementById('jugador1');
    let jugadorSeleccionadoParaAccion = null;
    let jugadorSeleccionadoParaCambio = null;

    // Cronómetro
    let tiempo = 0;
    let temporizador;
    let enMarcha = false;

    // Función para convertir el tiempo a mm:ss
    function formatearTiempo(segundos) {
      const minutos = Math.floor(segundos / 60);
      const segundosRestantes = segundos % 60;
      const formatoMinutos = minutos < 10 ? `0${minutos}` : minutos;
      const formatoSegundos = segundosRestantes < 10 ? `0${segundosRestantes}` : segundosRestantes;
      return `${formatoMinutos}:${formatoSegundos}`;
    }

    // Función para iniciar el temporizador
    function iniciarTemporizador() {
      if (!enMarcha) { // Solo iniciar si no está ya en marcha
        enMarcha = true;
        temporizador = setInterval(() => {
          tiempo++;
          document.getElementById('timer').textContent = `Tiempo: ${formatearTiempo(tiempo)}`;
        }, 1000);
      }
    }

    // Función para pausar el temporizador
    function pausarTemporizador() {
      clearInterval(temporizador);
      enMarcha = false;
    }

    // Función para actualizar los jugadores en la cancha visualmente
    function actualizarCancha() {
      jugadoresEnCancha.forEach((jugador, index) => {
        jugadoresElements[index].innerHTML = `
            <div class="nombre">${jugador.nombre}</div>
            <div class="numero">${jugador.numero}</div>
        `;
      });
    }

    // Cargar los jugadores disponibles en el banquillo en el desplegable
    function cargarBanquillo() {
      selectBanquillo.innerHTML = '';
      jugadoresEnBanquillo.forEach(jugador => {
        const option = document.createElement('option');
        option.value = jugador.nombre;
        option.textContent = `${jugador.nombre} (#${jugador.numero})`;
        selectBanquillo.appendChild(option);
      });
    }

    // Añadir eventos de clic a los jugadores para seleccionar acción
    jugadoresElements.forEach(jugadorElement => {
      jugadorElement.addEventListener('click', () => {
        jugadorSeleccionadoParaAccion = jugadorElement;
        accionesJugadorDiv.style.display = 'block'; // Mostrar menú de acciones
      });
    });

    // Evento para confirmar la acción seleccionada
    document.getElementById('confirmarAccion').addEventListener('click', () => {
      const accionSeleccionada = selectAccion.value;
      if (jugadorSeleccionadoParaAccion && accionSeleccionada) {
        switch (accionSeleccionada) {
          case 'gol':
            console.log(`${jugadorSeleccionadoParaAccion.textContent} ha metido gol al minuto ${formatearTiempo(tiempo)}`);
            break;
          case 'asistencia':
            console.log(`${jugadorSeleccionadoParaAccion.textContent} ha dado asistencia al minuto ${formatearTiempo(tiempo)}`);
            break;
          case 'tarjeta':
            console.log(`${jugadorSeleccionadoParaAccion.textContent} ha recibido tarjeta al minuto ${formatearTiempo(tiempo)}`);
            break;
          case 'cambio':
            cambioJugadorDiv.style.display = 'block';
            jugadorSeleccionadoParaCambio = jugadorSeleccionadoParaAccion;
            cargarBanquillo();
            break;
        }
        accionesJugadorDiv.style.display = 'none';
      }
    });

    // Evento para confirmar el cambio de jugador
    document.getElementById('confirmarCambio').addEventListener('click', () => {
      const jugadorSeleccionado = selectBanquillo.value;

      if (jugadorSeleccionadoParaCambio && jugadorSeleccionado) {
        const nombreJugadorEnCancha = jugadorSeleccionadoParaCambio.querySelector('.nombre').textContent.trim();
        const index = jugadoresEnCancha.findIndex(j => j.nombre.toLowerCase() === nombreJugadorEnCancha.toLowerCase());

        if (index !== -1) {
          const jugadorEnCancha = jugadoresEnCancha[index];
          const nuevoJugador = jugadoresConvocados.find(j => j.nombre === jugadorSeleccionado);

          if (nuevoJugador) {
            jugadoresEnCancha[index] = nuevoJugador;
            jugadoresEnBanquillo = jugadoresEnBanquillo.filter(j => j.nombre !== nuevoJugador.nombre);
            jugadoresEnBanquillo.push(jugadorEnCancha);

            actualizarCancha();
            cargarBanquillo();
            cambioJugadorDiv.style.display = 'none';
            console.log(`${jugadorEnCancha.nombre} ha sido reemplazado por ${nuevoJugador.nombre} al minuto ${formatearTiempo(tiempo)}.`);
          }
        } else {
          console.error("El jugador seleccionado para el cambio no está en cancha.");
        }
      }
    });

    // Cargar los jugadores en la cancha al cargar la página
    window.onload = function () {
      actualizarCancha();
    }

    // Eventos de los botones de inicio y pausa
    document.getElementById('iniciarPartido').addEventListener('click', iniciarTemporizador);
    document.getElementById('pausarPartido').addEventListener('click', pausarTemporizador);
  </script>

</body>

</html>